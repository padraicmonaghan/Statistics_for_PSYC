{
  "hash": "bcc0b1ce44b88009ee996f4116070aed",
  "result": {
    "markdown": "---\ntitle: 4. Mediation\nsubtitle: Emma Mills\norder: 5\n---\n\n\n\n\n# Lecture\n\nWatch the lecture on mediation theory [here](https://modules.lancaster.ac.uk/mod/url/view.php?id=2048690)\n\nWatch the mediation demonstration [here](https://modules.lancaster.ac.uk/mod/url/view.php?id=2048691)\n\n## Differences between means\n\nT-tests helps answer the question:\n+ 'Is there a difference between two groups in performance on X?'\n\nANOVA helps answer the question:\n+ 'Is there a difference between two or more groups / factors in performance on X?'\n\nWith a 3rd variable we can see if this affects performace at different levels ‚Äì we can introduce an interaction term...\n\n## Association:  Correlation -> Regression\n\nMeasures of association help answer the question 'What is the relationship between two variables?'\n\nCorrelation looks at pairs of variables\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(DiagrammeR)\n\ngrViz(diagram = \"digraph flowchart {\n  rankdir=LR;\n  node [fontname = arial, shape = oval]\n  tab1 [label = '@@1']\n  tab2 [label = '@@2']\n\n  tab1 -> tab2 [dir='both'];\n}\n  \n  [1]: 'X'\n  [2]: 'Y'\n  \") \n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"htmlwidget-959aec6f6f0fe4ee25c4\" style=\"width:100%;height:464px;\" class=\"grViz html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-959aec6f6f0fe4ee25c4\">{\"x\":{\"diagram\":\"digraph flowchart {\\n  rankdir=LR;\\n  node [fontname = arial, shape = oval]\\n  tab1 [label = \\\"X\\\"]\\n  tab2 [label = \\\"Y\\\"]\\n\\n  tab1 -> tab2 [dir=\\\"both\\\"];\\n}\",\"config\":{\"engine\":\"dot\",\"options\":null}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n\nRegressions chooses one as the outcome variable & one as the predictor variable\n+ Simple regression = 1 outcome and 1 predictor\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngrViz(diagram = \"digraph flowchart {\n  rankdir=LR;\n  node [fontname = arial, shape = oval]\n  tab1 [label = '@@1']\n  tab2 [label = '@@2']\n\n  tab1 -> tab2;\n}\n  \n  [1]: 'X'\n  [2]: 'Y'\n  \") \n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"htmlwidget-87fc7b59da12c6d24dd3\" style=\"width:100%;height:464px;\" class=\"grViz html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-87fc7b59da12c6d24dd3\">{\"x\":{\"diagram\":\"digraph flowchart {\\n  rankdir=LR;\\n  node [fontname = arial, shape = oval]\\n  tab1 [label = \\\"X\\\"]\\n  tab2 [label = \\\"Y\\\"]\\n\\n  tab1 -> tab2;\\n}\",\"config\":{\"engine\":\"dot\",\"options\":null}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n+ Multiple regression = 1 outcome and 1+ predictor\n  + Interactions also possible\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngrViz(diagram = \"digraph flowchart {\n  rankdir=LR;\n  node [fontname = arial, shape = oval]\n  tab1 [label = '@@1']\n  tab2 [label = '@@2']\n  tab3 [label = '@@3']\n\n  tab1 -> tab3;\n  tab2 -> tab3;\n\n  {rank=same; tab1, tab2}\n\n}\n  \n  [1]: 'X1'\n  [2]: 'X2'\n  [3]: 'Y'\n  \") \n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"htmlwidget-ebcd4ec36479fd93b364\" style=\"width:100%;height:464px;\" class=\"grViz html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-ebcd4ec36479fd93b364\">{\"x\":{\"diagram\":\"digraph flowchart {\\n  rankdir=LR;\\n  node [fontname = arial, shape = oval]\\n  tab1 [label = \\\"X1\\\"]\\n  tab2 [label = \\\"X2\\\"]\\n  tab3 [label = \\\"Y\\\"]\\n\\n  tab1 -> tab3;\\n  tab2 -> tab3;\\n\\n  {rank=same; tab1, tab2}\\n\\n}\",\"config\":{\"engine\":\"dot\",\"options\":null}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n\n## Mediation: a causal model\n\nMediation helps answer the question:\n+ 'how does a predictor variable (X) influence / effect the outcome variable (Y)?'\n\nWe assume a third variable is involved\n+ The third variable is called the mediator (M)\n+ It is situated between the predictor (X) and outcome variable (Y)\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngrViz(diagram = \"digraph {\n  rankdir=LR;\n  node [fontname = arial, shape = circle]\n  ranksep = .5;\n\n  tab1 [label = 'X']\n  tab2 [label = 'M']\n  tab3 [label = 'Y']\n\n  tab1 -> tab3;\n  tab1 -> tab2 -> tab3;\n\n\n}\n  \") \n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"htmlwidget-352b31a233f4c2eb7138\" style=\"width:100%;height:464px;\" class=\"grViz html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-352b31a233f4c2eb7138\">{\"x\":{\"diagram\":\"digraph {\\n  rankdir=LR;\\n  node [fontname = arial, shape = circle]\\n  ranksep = .5;\\n\\n  tab1 [label = \\\"X\\\"]\\n  tab2 [label = \\\"M\\\"]\\n  tab3 [label = \\\"Y\\\"]\\n\\n  tab1 -> tab3;\\n  tab1 -> tab2 -> tab3;\\n\\n\\n}\\n  \",\"config\":{\"engine\":\"dot\",\"options\":null}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n## Mediation: parts of the model\n\nUnmediated relationship\n+ path of total effect = c\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngrViz(diagram = \"digraph flowchart {\n  rankdir=LR;\n  node [fontname = arial, shape = oval]\n  tab1 [label = '@@1']\n  tab2 [label = '@@2']\n\n  tab1 -> tab2 [label = 'c'];\n}\n  \n  [1]: 'X'\n  [2]: 'Y'\n  \") \n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"htmlwidget-f8375f3a054e963ce3e1\" style=\"width:100%;height:464px;\" class=\"grViz html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-f8375f3a054e963ce3e1\">{\"x\":{\"diagram\":\"digraph flowchart {\\n  rankdir=LR;\\n  node [fontname = arial, shape = oval]\\n  tab1 [label = \\\"X\\\"]\\n  tab2 [label = \\\"Y\\\"]\\n\\n  tab1 -> tab2 [label = \\\"c\\\"];\\n}\",\"config\":{\"engine\":\"dot\",\"options\":null}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\nMediated relationship\n+ mediator variable (M)\n+ path of indirect effect = ab\n  + a = X predicts M\n  + b = M predicts Y\n+ path of direct effect = c‚Äô\n+ ab + c‚Äô = c = total effect of X on Y\n  + either partial or full mediation\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngrViz(diagram = \"digraph {\n  rankdir=LR;\n  node [fontname = arial, shape = circle]\n  ranksep = .5;\n\n  tab1 [label = 'X']\n  tab2 [label = 'M']\n  tab3 [label = 'Y']\n\n  tab1 -> tab3 [label = 'c`'];\n  tab1 -> tab2 [label = 'a'];\n  tab2-> tab3 [label = 'b'];\n\n\n}\n  \") \n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"htmlwidget-73c6f8fbd8e70560fa67\" style=\"width:100%;height:464px;\" class=\"grViz html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-73c6f8fbd8e70560fa67\">{\"x\":{\"diagram\":\"digraph {\\n  rankdir=LR;\\n  node [fontname = arial, shape = circle]\\n  ranksep = .5;\\n\\n  tab1 [label = \\\"X\\\"]\\n  tab2 [label = \\\"M\\\"]\\n  tab3 [label = \\\"Y\\\"]\\n\\n  tab1 -> tab3 [label = \\\"c`\\\"];\\n  tab1 -> tab2 [label = \\\"a\\\"];\\n  tab2-> tab3 [label = \\\"b\\\"];\\n\\n\\n}\\n  \",\"config\":{\"engine\":\"dot\",\"options\":null}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n## Mediation: conditions\n\n1. X need not be a significant predictor of Y\n2. M must not be a primary predictor variable\n3. M must not be any of the study conditions\n4. M must be dependent upon X\n5. M must reduce or eradicate the impact of X on Y\n\n## Mediation: Different types: partial and full\n\nWhen path c‚Äô is reduced but non-zero\nMediation is said to be partial\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngrViz(diagram = \"digraph {\n  rankdir=LR;\n  node [fontname = arial, shape = circle]\n  ranksep = .5;\n\n  tab1 [label = 'X']\n  tab2 [label = 'M']\n  tab3 [label = 'Y']\n\n  tab1 -> tab3 [label = 'c` >0'];\n  tab1 -> tab2 [label = '>0 a'];\n  tab2-> tab3 [label = 'b >0'];\n\n\n}\n  \") \n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"htmlwidget-ec79b434fe740a502535\" style=\"width:100%;height:464px;\" class=\"grViz html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-ec79b434fe740a502535\">{\"x\":{\"diagram\":\"digraph {\\n  rankdir=LR;\\n  node [fontname = arial, shape = circle]\\n  ranksep = .5;\\n\\n  tab1 [label = \\\"X\\\"]\\n  tab2 [label = \\\"M\\\"]\\n  tab3 [label = \\\"Y\\\"]\\n\\n  tab1 -> tab3 [label = \\\"c` >0\\\"];\\n  tab1 -> tab2 [label = \\\">0 a\\\"];\\n  tab2-> tab3 [label = \\\"b >0\\\"];\\n\\n\\n}\\n  \",\"config\":{\"engine\":\"dot\",\"options\":null}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\nWhen path c‚Äô is at 0\nMediation is said to be complete or full\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngrViz(diagram = \"digraph {\n  rankdir=LR;\n  node [fontname = arial, shape = circle]\n  ranksep = .5;\n\n  tab1 [label = 'X']\n  tab2 [label = 'M']\n  tab3 [label = 'Y']\n\n  tab1 -> tab3 [label = 'c` =0'];\n  tab1 -> tab2 [label = '>0 a'];\n  tab2-> tab3 [label = 'b >0'];\n\n\n}\n  \") \n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"htmlwidget-700f8d6c22524e90be52\" style=\"width:100%;height:464px;\" class=\"grViz html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-700f8d6c22524e90be52\">{\"x\":{\"diagram\":\"digraph {\\n  rankdir=LR;\\n  node [fontname = arial, shape = circle]\\n  ranksep = .5;\\n\\n  tab1 [label = \\\"X\\\"]\\n  tab2 [label = \\\"M\\\"]\\n  tab3 [label = \\\"Y\\\"]\\n\\n  tab1 -> tab3 [label = \\\"c` =0\\\"];\\n  tab1 -> tab2 [label = \\\">0 a\\\"];\\n  tab2-> tab3 [label = \\\"b >0\\\"];\\n\\n\\n}\\n  \",\"config\":{\"engine\":\"dot\",\"options\":null}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\nBut be mindful of power ‚Äì bootstrap method offers strongest solution here.\n\n## Additional assumptions to the linear model assumptions\n\nA mediated model follows all the assumptions of linear regression\n\nAs an explanatory process, a predictor (X) can be said to be ‚Äòcausally‚Äô related to the outcome (Y) when:\n+ X is associated with Y\n+ X precedes changes in Y\n+ No other unmeasured variables are related to X and also affect Y\n\nX should / could precede M in time\n\nM should significantly predict Y but Y could also significantly predict M\n+ M and Y could be correlated if they are both causally related to X. \n+ Swapping the order of variables can check this\nHigh power\n+Study design can help this: from weakest to strongest for assumptions\n  +Cross-sectional design (v. popular in student projects ‚Äì beware‚Ä¶)\n  +Panel designs that allow for staggered measurement in waves\n  +Experimental designs with random assignment and manipulated variables\n\n## Method: 4 step approach (Baron & Kenny, 1986)\n\n### Step 1:\n\nTest path of total effect\n=    Test the significance of slope c\n=    Linear regression of X on Y\n ùëå=ùëè_(0  ) + ùëè_1 ùëã\n= a simple, straightforward simple regression\n\n### Step 2 & 3:\n\nTest path of indirect effect a and b\n=    Test the significance of slope a and slope b in two independent models\n=    Linear regression of X on M\n M =ùëè_(0  )+ ùëè_1 ùëã\n=    Linear regression of M on Y while controlling for X\n=     Y =ùëè_(0  )+ùëè_1 ùëã+ùëè_2 ùëÄ\n\n### Step 4:\n\nTest if c‚Äô < c\n=     $Y=b_0=  b_1X + b_2M$ \n(step 3 and 4 are in the same equation / model)\n\nIf c‚Äô is significant = partial mediation\nIf c‚Äô is non- significant = full mediation\n\n## Method: Bootstrap test\u000b(Preacher & Hayes, 2004, 2008)\n\n+ Automated process\n+ Resampling method for the indirect pathway using the model data with replacement\n+ Indirect pathway (ab) estimated for each set of sampled data\n+ Average = indirect effect estimate\n+ Generates confidence intervals also\n+ `mediation` package (Tingley et al., 2013) in R\n\n## Reporting Results\n\nReport the indirect effect and its confidence intervals\n+ This is generally the effect with the most power\n+ A nonsignificant test for c‚Äô may occur due to low power \n  + i.e. give a Type II Error \n  + Be careful of claiming full / complete mediation given this information\nReport each pathway with either its significance value or confidence interval\n+ Pathways a, b, c‚Äô and c\nDiscuss how the additional assumptions of mediation analysis are met\nMuller et al. (2008) give further details.\n\n## Interpreting Results\n\n+ Benefits of a direct effect in the context of a significant indirect effect (partial mediation) ‚Äì it informs theory development\n+ Size of the indirect effect indicates the strength of mediation\n+ Zhao et al. (2010) gave descriptive labels to mediation as a function of the directions of effect for the direct and indirect pathways:\n  + Complementary ‚Äì effects for both pathways are in the same direction\n  + Competitive ‚Äì effects for both pathways are in opposite directions\n\n## Extensions\n\nHayes (2018)  talks about:\n+ Moderated mediation\n+ The mediator depends on a fourth variable (!eek) and it could be\n+ partial moderated mediation\n+ conditional moderated mediation\n+ moderated moderated mediation\n\nOut of scope for this module, but have a think when you are designing your studies!\n\n\n## Demonstration \n\n\n\n\n\n### Mediation analysis\n\nIn this demonstration, we will model a mediation analysis. The total effect of an unmediated relationship is below in pathway c.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- c(0, \"a\", 0,\n          0, 0, 0, \n          \"b\", \"c\", 0)\nM<- matrix (nrow=3, ncol=3, byrow = TRUE, data=data)\nplot<- plotmat (M, pos=c(1,2), \n                name= c( \"M\",\n                         \"Supervision\", \n                         \"Dissertation \\nPerformance\"), \n                box.type = \"rect\", \n                box.size = 0.12, \n                box.prop=0.5,  \n                curve=0)\n```\n\n::: {.cell-output-display}\n![](Week4_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\nWe are going to test for the mediator variable of `self esteem`.  This needs the prime mark added to the direct pathway \"c\" text!\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- c(0, \"a\", 0,\n          0, 0, 0, \n          \"b\", \"c\", 0)\nM<- matrix (nrow=3, ncol=3, byrow = TRUE, data=data)\nplot<- plotmat (M, pos=c(1,2), \n                name= c( \"Self-esteem\",\n                         \"Supervision\", \n                         \"Dissertation \\nPerformance\"), \n                box.type = \"rect\", \n                box.size = 0.12, \n                box.prop=0.5,  \n                curve=0)\n```\n\n::: {.cell-output-display}\n![](Week4_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n### Read in the data\n\nFirst download the data file from [here](data/Wk4/mediation exercise 2 data.sav) and upload to the R server.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd_full <- read_sav(\"mediation exercise 2 data.sav\")\n\nhead(d_full)\n```\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 √ó 3\n  supervision self_esteem dissertation_performance\n        <dbl>       <dbl>                    <dbl>\n1        2.67        3.14                     3   \n2        2.67        3.57                     3.56\n3        3.33        3                        3.41\n4        3.33        2.57                     1   \n5        2.67        4.71                     2.26\n6        2.67        3.29                     2.41\n```\n:::\n:::\n\n\nEarly in the construction of the script, I noticed that there were different levels of missingness across the models - this means that coefficients are estimated on different datasets, so we are introducing a potential source of systematic error if we do not correct for this.\n\nChecking for missingness:\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(d_full)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  supervision     self_esteem    dissertation_performance\n Min.   :1.667   Min.   :1.571   Min.   :1.000           \n 1st Qu.:3.333   1st Qu.:3.286   1st Qu.:2.380           \n Median :4.000   Median :3.857   Median :3.037           \n Mean   :3.786   Mean   :3.864   Mean   :3.028           \n 3rd Qu.:4.333   3rd Qu.:4.500   3rd Qu.:3.593           \n Max.   :5.000   Max.   :5.714   Max.   :5.815           \n                 NA's   :2       NA's   :3               \n```\n:::\n:::\n\nFor the purposes of this analysis, I will remove the observations (rows) with NA values. This is not the best way of working with missingness, but for the purposes of the demonstration it is ok.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd <- na.omit(d_full) # 4 observations removed\nsummary(d) # no NA values listed\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  supervision     self_esteem    dissertation_performance\n Min.   :1.667   Min.   :1.571   Min.   :1.000           \n 1st Qu.:3.333   1st Qu.:3.286   1st Qu.:2.370           \n Median :4.000   Median :3.857   Median :3.074           \n Mean   :3.791   Mean   :3.853   Mean   :3.030           \n 3rd Qu.:4.333   3rd Qu.:4.429   3rd Qu.:3.593           \n Max.   :5.000   Max.   :5.714   Max.   :5.815           \n```\n:::\n:::\n\n\nI am going to copy and rename the variables to save on typing\n\n X = supervision\n Y = dissertation_performance\n M = self_esteem\n \n\n::: {.cell}\n\n```{.r .cell-code}\nd <- d %>% \n  mutate(X = supervision,\n         Y = dissertation_performance,\n         M = self_esteem)\n```\n:::\n\n \n\n### Longhand - Steps of Baron & Kenny (1986)\n\nFour independent linear regression models\n\n  1. The effect of X on Y (total effect = pathway c)\n  2. The effect of X on M (indirect effect pathway a)\n  3. The effect of M on Y (indirect effect pathway b) while controlling for X\n  4. The effect of X and M on Y (for direct effect estimation = pathway c')\n  \nWhen running your models, you need to assign them to objects in the environment to then be able to use them in a call to the `mediation` package.\n\n#### Step 1: Test the total effect - pathway c\n\n\n\n$$\nY = b_0 + b_1 * X + e\n$$\n\nvia a simple regression model:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(fit_total <-  summary(lm(Y ~ X, d)))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = Y ~ X, data = d)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1.83011 -0.56623 -0.04308  0.51478  2.25553 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   1.3718     0.4679   2.931 0.004470 ** \nX             0.4375     0.1209   3.620 0.000532 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.8361 on 75 degrees of freedom\nMultiple R-squared:  0.1488,\tAdjusted R-squared:  0.1374 \nF-statistic: 13.11 on 1 and 75 DF,  p-value: 0.0005321\n```\n:::\n:::\n\n\nThe total effect of our predictor on our outcome is significant.  In other words, supervision on dissertation performance is significant (*p* < .001). A change in one unit of supervision is associated with an increase in dissertation performance of 0.44.\n\nThere is an effect that can be tested for mediation.\n\n#### Step 2: Test the a pathway of the indirect effect\n\n$$\nM = b_0 + b_1 * X + e\n$$\na second simple regression model, using X as a predictor but this time, M (self esteem here) is our outcome variable:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(fit_indirecta <- summary(lm(M ~ X, d)))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = M ~ X, data = d)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-2.34553 -0.48838  0.02337  0.61288  1.49353 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   2.7018     0.4406   6.132 3.74e-08 ***\nX             0.3038     0.1138   2.670   0.0093 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.7872 on 75 degrees of freedom\nMultiple R-squared:  0.08679,\tAdjusted R-squared:  0.07461 \nF-statistic: 7.128 on 1 and 75 DF,  p-value: 0.0093\n```\n:::\n:::\n\n\nThe indirect effect pathway a (X on M) is also significant (*p* = .009). A change in one unit of supervision is associated with an increase in self-esteem of 0.30.\n\nSo now we know that X and M share some variance - they are correlated.  We have met one of the assumptions that we need to be able to perform a mediation analysis.\n\n#### Step 3 & 4: Test the b pathway of the indirect effect & the direct effect (pathway c')\n\n$$\nY = b_0 + b_1 * X + b_2 * M + e\n$$\nA multiple regression model, with Y (dissertation performance) as our outcome variable, and X (supervision) and M (self-esteem) as predictors.  Remember that this model is controlling for the effect of X on Y, because interpreting one predictor in a multiple regression model always assumes that the effect of the other predictors are already taken care of, or controlled for.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(fit_indirectb <- summary(lm(Y ~ X + M, d)))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = Y ~ X + M, data = d)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1.39749 -0.48798  0.02245  0.44603  1.29565 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -0.46168    0.44402  -1.040   0.3018    \nX            0.23135    0.09794   2.362   0.0208 *  \nM            0.67861    0.09497   7.145 5.26e-10 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.6475 on 74 degrees of freedom\nMultiple R-squared:  0.4963,\tAdjusted R-squared:  0.4827 \nF-statistic: 36.46 on 2 and 74 DF,  p-value: 9.564e-12\n```\n:::\n:::\n\n\nThe indirect effect pathway b (M on Y), while controlling for X is also significant (*p* < .001). A change in one unit of self-esteem is associated with an increase in dissertation-performance of 0.68 of a unit. The predictor (X) relationship with the outcome (Y and pathway c' - the direct effect) remains significant also (*p* < .02 , but reduced relative to the step 1 model coefficient (step 1 $b$ = 0.44, step 4 $b$ = 0.23).  \n\nSince the direct pathway c' is significant, we can say that we have a partially mediated effect of self-esteem on the relationship between supervision and dissertation performance.  Supervision predicts self esteem and dissertation performance, while self esteem also predicts dissertation performance.\n\nIf instead the X coefficient in the model above had been > .05 i.e. no significant, we could have claimed a full or complete mediation of self esteem on the relationship between supervision and dissertation performance\n\n### Using the power of R and the `mediation` package\n\nThe `mediation` package is called by the library() function loaded at the top of the document.  \n\n - It takes the models for pathways a and b (`fit_indirecta` and `fitindirectb` here), \n - It needs us to tell it the name of the predictor or treatment variable and the name of the mediator variable as labelled in the models \n - and we set the `boot` argument to T for TRUE, to be able to generate confidence intervals on our co-efficients.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nresults <- mediate(fit_indirecta, \n                   fit_indirectb, \n                   treat = 'X', \n                   mediator = 'M', \n                   boot = T, \n                   dropobs = TRUE)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRunning nonparametric bootstrap\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(results)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCausal Mediation Analysis \n\nNonparametric Bootstrap Confidence Intervals with the Percentile Method\n\n               Estimate 95% CI Lower 95% CI Upper p-value    \nACME             0.2062       0.0625         0.40   0.006 ** \nADE              0.2313       0.0390         0.41   0.020 *  \nTotal Effect     0.4375       0.2220         0.65  <2e-16 ***\nProp. Mediated   0.4712       0.1802         0.86   0.006 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nSample Size Used: 77 \n\n\nSimulations: 1000 \n```\n:::\n:::\n\n\n - **ACME** stands for *average causal mediation effects* and is the product of pathway a and pathway b from `fit indirecta` (X = 0.3037992) and `fit_indirectb` (M = 0.6786069).\n - **ADE** stands for average direct effects or pathway c'.  This is the X coefficient in our `fit_indirectb`\n - **Total Effect** does what it says on the tin.  It is the sum of the direct and indirect effect, ACME + ADE, and also calculated  as X in model `fit_total`.\n - **Prop. Mediated** is the proportion of the effect of X on Y that goes through M.  We divide ACME (or ab) by the total effect (c).\n \n\n::: {.cell}\n\n```{.r .cell-code}\nplot(results)\n```\n\n::: {.cell-output-display}\n![](Week4_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\n### Reporting the mediation analysis\n\nand to use our diagram from the top of the document:\n\nWe are going to test for the mediator variable of `self esteem`.  (This needs the prime mark added to the direct pathway \"c\" text!)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- c(0, 0.30, 0,\n          0, 0, 0, \n          0.68, 0.23, 0)\nM<- matrix (nrow=3, ncol=3, byrow = TRUE, data=data)\nplot<- plotmat (M, pos=c(1,2), \n                name= c( \"Self-esteem\",\n                         \"Supervision\", \n                         \"Dissertation \\nPerformance\"), \n                box.type = \"rect\", \n                box.size = 0.12, \n                box.prop=0.5,  \n                curve=0)\n```\n\n::: {.cell-output-display}\n![](Week4_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n(Remember that these data are not standardised so we cannot compare between them for strength of relationships!)\n\nThe effect of supervision on dissertation performance was partially mediated via self-esteem.  The effect of supervision on dissertation performance and the effect of self-esteem on dissertation performance were independently significant predictors.  The indirect effect equals (.3)*(0.68) = .0.21.  We tested the significance of this indirect effect using bootstrapping procedures. We computed the average indirect effect over 1,000 bootstrapped samples with 95% confidence intervals (bootstrapped indirect effect = 0.21 95% CI [0.06, 0.38]). Since the confidence intervals do not cross zero, we infer statistical significance.\n\n\n# Lab Tasks\n\nYou can download the .zip folder that's needed for this lab from [here](data/Wk4/Lab 4 Materials.zip), which contains a starter .Rmd file and the data needed.\n\nUse the lecture script as a model to help you.\n\n## Descriptive Statistics:  describe the variables:\n\n+ Prompts:  continuous / categorical?  Levels? Which one is the reference level if categorical?\n+ Report the outcome variable (Y)\n+ Report the predictor variables (Xs)\n+ Summary stats for continuous variables = calculate and report the mean and sd values for each variable.\n\nMediation analysis ‚Äì 4 step approach\n\nStep 1:  Total effect: Run the code and write a short paragraph of results\n\nStep 2: Indirect effect path a: Run the code and write a short paragraph of results.\n\nStep 3 & 4: Indirect effect path b and direct effect path: Run the code and write a short paragraph of results.\n\n## Questions\n\n1. Is there a total effect?\n2. Is there an indirect path effect for X predicting the mediator M?\n3. Is there an effect for indirect path of mediator M on outcome Y?\n4. Is there an effect of direct path of X on Y?\n5. Is there a mediated effect of coffee on problem solving?\n6. If so, what type of mediation is it?\n7.Why have you decided that type of mediation? \n\n## Bootstrap method\n\nRun the bootstrap method\nReport the following values to 2 dp.\n\n8.\tWhat is the average causal mediation effect value?\n9.\tWhat is the average direct effect value?\n10.\tWhat is the total effect value?\n11.\tWhat proportion of variance goes through the indirect pathway?\n\nDraw the mediation analysis diagram with the correct values on the pathways.\n\nReport the bootstrap analysis and the results.  \n\n# Submit Scripts\n\nRemember to submit your group scripts if you want to receive and see feedback on your own and other groups' scripts.",
    "supporting": [
      "Week4_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/htmlwidgets-1.5.4/htmlwidgets.js\"></script>\n<script src=\"../site_libs/viz-1.8.2/viz.js\"></script>\n<link href=\"../site_libs/DiagrammeR-styles-0.2/styles.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/grViz-binding-1.0.9/grViz.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}